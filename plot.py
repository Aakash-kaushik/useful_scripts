from matplotlib import pyplot as plt
import numpy as np
import pickle

#val={'loss': [1.3045552994615288, 1.1900323757561304, 1.1185934293654658, 1.0594962053401495, 1.0202630854422046, 0.9871009453650443, 0.9622969069788533, 0.9403848712162305, 0.9190088132376312, 0.9031025139234399, 0.8880012298143038, 0.8785935390380121, 0.8663519101758157, 0.8498752482475773, 0.8391326326195911, 0.8361385599259408, 0.8281014709062474, 0.8238694385815692, 0.8141016549961542, 0.8125741212598739, 0.8041156882880837, 0.8015982508659363, 0.7936484640644442, 0.7909171247995028, 0.7876278892640145, 0.7846592184036009, 0.7799266820312828, 0.775705825257045, 0.7763192506246669, 0.7677510662745404, 0.7696413981017246, 0.7687551956022939, 0.7639708845846115, 0.7624441609587721, 0.758474991526655, 0.7590943728723833, 0.7532552044878724, 0.7588154212121041, 0.7502537273591564, 0.7508156543136925, 0.7439874365765561, 0.753660753850014, 0.7423010013436758, 0.7457191405757781, 0.7445101103475017, 0.7352497910940519, 0.7401565197975405, 0.7382947017428696, 0.7349393515176671, 0.7363791007508513, 0.7292632736185546, 0.7373953035441778, 0.7276016730134205, 0.7296862666324903, 0.725362031690536, 0.7340133609951184, 0.7265131018495047, 0.7287254086745683, 0.7287427209397798, 0.7290028022822513, 0.7268220157392563, 0.7279490636241052, 0.7379953415804011, 0.7264135614518197, 0.7294792661102869, 0.7237796693719843, 0.726770733312894, 0.7254695953220449, 0.7201464877974603, 0.7174015000302304, 0.719274232464452, 0.7236584184631225, 0.7207623031190646, 0.7177552276401109, 0.7161375925105106, 0.7261544789678307, 0.7282136752400347, 0.725128202028172, 0.7193728586037954, 0.7376616651652962, 0.717538788754453, 0.7303770190926009, 0.7217596897514917, 0.7155544712979306, 0.7317781352227734, 0.7122780943429599, 0.7290217158614948, 0.7208782822214147, 0.718359238037499, 0.7207162473150479, 0.7165694861642776, 0.7187281651522524, 0.7159508335333998, 0.7164084328118191, 0.7222800690640685, 0.7154199000327818, 0.7230665872814834, 0.7141084283269862, 0.7181603911743369, 0.7161701946489273, 0.7204289618999727, 0.7320029562519442, 0.7180729572490979, 0.7286318649527848, 0.7265113826080035, 0.7081638564986568, 0.7212254001248267, 0.7218487317203194, 0.7105604836376764, 0.7142419696495097, 0.7161621220650212, 0.7131993966076964, 0.7172268837369898, 0.7111976265266378, 0.7206230971121019, 0.7152328779620509, 0.7151370279250606, 0.7179912822220915, 0.7183428249692404, 0.7169684927950624, 0.7150704123640573, 0.7205559787570789, 0.7119374413003203, 0.7205201256018813, 0.7146767871354216, 0.7198675877304488, 0.7206362133385033, 0.7081846588401384, 0.7204083226701264, 0.7137588579808513, 0.7101984450253107, 0.7157631333797209, 0.7165444057474855, 0.7091253040939249, 0.7173540489647978, 0.7137435809258492, 0.7288333257680298, 0.7190907857110423, 0.722676291260668, 0.7207434414535441, 0.711626245449948, 0.7132059662572799, 0.7172558547989014, 0.7196223940900577, 0.7198540299169479, 0.7082286031656367, 0.7224364085223085, 0.7264803721699663, 0.7151686513936648, 0.7225806094625945, 0.7125060452568915, 0.719123779125111, 0.7172638068916977, 0.7219181951656136, 0.7133892361194857, 0.7246049645767417, 0.7153623565550773, 0.7278778226144852, 0.7197251416021778, 0.7124268252362487, 0.744800103287543, 0.7131064944369818, 0.7235309843735028, 0.7207292228616694, 0.7198080375630368, 0.7414559641832946, 0.728694821237236, 0.7203218084509655, 0.7167607154897464, 0.730131721304309, 0.731237885772541, 0.7193642348371526, 0.7286496316232989, 0.7167301610592873, 0.7258050172559677, 0.7457590542172873, 0.7174975862426143, 0.7223295793738417, 0.7162362141634828, 0.7236863451619302, 0.7141896739441861, 0.7329471418934483, 0.7266734364212201, 0.7350389838859599, 0.7215641256301634, 0.7260130916231422, 0.7214204210747954, 0.7261396120953304, 0.7297470745860889, 0.7341792618715635, 0.7239123477089789, 0.7312096251595405, 0.7227056680187103, 0.7277727806439964, 0.7245435906994727, 0.7308457695668743, 0.728829909716883, 0.7326066615760968, 0.7286890793231225, 0.7207511596141323], 'acc': [0.4731182795698925, 0.5967741935483871, 0.6182795698924731, 0.6236559139784946, 0.6344086021505377, 0.6397849462365592, 0.6397849462365592, 0.6666666666666667, 0.6666666666666667, 0.6666666666666667, 0.6881720430107527, 0.6774193548387097, 0.6666666666666667, 0.7043010752688172, 0.6935483870967742, 0.6827956989247312, 0.6935483870967742, 0.6827956989247312, 0.7043010752688172, 0.6827956989247312, 0.6989247311827957, 0.6935483870967742, 0.7043010752688172, 0.6989247311827957, 0.7204301075268817, 0.6827956989247312, 0.6935483870967742, 0.6989247311827957, 0.6720430107526882, 0.7043010752688172, 0.6720430107526882, 0.7043010752688172, 0.7043010752688172, 0.6881720430107527, 0.6989247311827957, 0.6989247311827957, 0.6827956989247312, 0.6666666666666667, 0.6827956989247312, 0.6989247311827957, 0.6774193548387097, 0.6827956989247312, 0.6881720430107527, 0.6827956989247312, 0.6827956989247312, 0.6989247311827957, 0.6881720430107527, 0.6881720430107527, 0.7150537634408602, 0.6881720430107527, 0.6989247311827957, 0.6827956989247312, 0.6935483870967742, 0.6989247311827957, 0.7043010752688172, 0.6881720430107527, 0.6881720430107527, 0.6774193548387097, 0.6881720430107527, 0.6935483870967742, 0.6827956989247312, 0.7043010752688172, 0.6612903225806452, 0.7096774193548387, 0.6935483870967742, 0.6989247311827957, 0.6935483870967742, 0.6881720430107527, 0.7043010752688172, 0.6935483870967742, 0.6989247311827957, 0.6827956989247312, 0.6881720430107527, 0.6989247311827957, 0.7043010752688172, 0.6935483870967742, 0.6935483870967742, 0.6989247311827957, 0.6935483870967742, 0.6881720430107527, 0.7043010752688172, 0.6827956989247312, 0.6935483870967742, 0.7043010752688172, 0.6827956989247312, 0.7096774193548387, 0.6774193548387097, 0.7043010752688172, 0.6989247311827957, 0.7043010752688172, 0.6989247311827957, 0.6881720430107527, 0.6935483870967742, 0.6881720430107527, 0.6881720430107527, 0.7043010752688172, 0.6881720430107527, 0.6989247311827957, 0.6881720430107527, 0.6989247311827957, 0.6827956989247312, 0.6774193548387097, 0.6827956989247312, 0.6827956989247312, 0.6827956989247312, 0.6881720430107527, 0.6881720430107527, 0.6881720430107527, 0.6989247311827957, 0.6720430107526882, 0.6989247311827957, 0.6881720430107527, 0.6774193548387097, 0.6935483870967742, 0.6881720430107527, 0.6881720430107527, 0.6935483870967742, 0.6720430107526882, 0.6881720430107527, 0.6774193548387097, 0.6935483870967742, 0.6720430107526882, 0.6881720430107527, 0.6827956989247312, 0.6827956989247312, 0.6774193548387097, 0.6774193548387097, 0.6881720430107527, 0.6774193548387097, 0.6827956989247312, 0.6935483870967742, 0.6827956989247312, 0.6827956989247312, 0.6827956989247312, 0.6881720430107527, 0.6827956989247312, 0.6666666666666667, 0.6774193548387097, 0.6881720430107527, 0.6666666666666667, 0.6881720430107527, 0.6827956989247312, 0.6774193548387097, 0.6881720430107527, 0.6989247311827957, 0.6881720430107527, 0.6881720430107527, 0.6774193548387097, 0.6774193548387097, 0.6774193548387097, 0.6774193548387097, 0.6935483870967742, 0.6720430107526882, 0.6827956989247312, 0.6720430107526882, 0.6774193548387097, 0.6827956989247312, 0.6774193548387097, 0.6774193548387097, 0.6989247311827957, 0.6881720430107527, 0.6774193548387097, 0.6827956989247312, 0.6827956989247312, 0.6827956989247312, 0.6720430107526882, 0.6774193548387097, 0.6827956989247312, 0.6720430107526882, 0.6827956989247312, 0.6774193548387097, 0.6827956989247312, 0.6774193548387097, 0.6881720430107527, 0.6559139784946237, 0.6559139784946237, 0.6827956989247312, 0.6827956989247312, 0.6881720430107527, 0.6720430107526882, 0.6827956989247312, 0.6666666666666667, 0.6935483870967742, 0.6720430107526882, 0.6827956989247312, 0.6774193548387097, 0.6827956989247312, 0.6827956989247312, 0.6881720430107527, 0.6720430107526882, 0.6881720430107527, 0.6827956989247312, 0.6935483870967742, 0.6720430107526882, 0.6774193548387097, 0.6827956989247312, 0.6559139784946237, 0.6774193548387097, 0.6774193548387097, 0.6935483870967742]}
#train={'loss': [1.3440274121809979, 1.2295143044724757, 1.1536081542774124, 1.0928613458360945, 1.0494030908662446, 1.0075175275607986, 0.9895140844948438, 0.9644375893534446, 0.9482900609775465, 0.9287391511761413, 0.9101541468075344, 0.9048662380296357, 0.8781238551042518, 0.862304578022081, 0.8562866558833998, 0.8599368467622873, 0.8491021516371746, 0.8362030180133119, 0.8335882267173456, 0.8249949569604835, 0.8431997128895351, 0.8205875255623643, 0.8086413923574953, 0.799978819428658, 0.7990651033362564, 0.7892429779986946, 0.7784191029412406, 0.7846189494035682, 0.7787688702953105, 0.7794892727112284, 0.7725143043362365, 0.7703433353073743, 0.7478660758660765, 0.739523882768592, 0.7300230848545931, 0.7476719861127892, 0.7304539084434509, 0.7566030280930656, 0.7317563477827578, 0.7171160517906656, 0.7290836037421713, 0.7210333274335278, 0.7184314046587262, 0.7167965769767761, 0.7228129177677388, 0.7135826957469084, 0.718186582837786, 0.7204105136345844, 0.7130204804089605, 0.6971201118157835, 0.6851550644757797, 0.6815116356830208, 0.7003912098553716, 0.7114941976508316, 0.7145283976379706, 0.695024693498806, 0.7124079003625986, 0.6847940573886949, 0.6890147985244284, 0.6954507110070209, 0.6987423544027367, 0.6786971505807371, 0.6884207725524902, 0.6723926261979707, 0.67092870206249, 0.6646704588617597, 0.670842064886677, 0.6539260781541163, 0.6596713260728486, 0.6646722944415345, 0.6306926498607713, 0.6556790574472777, 0.6739397657160856, 0.6574689344483979, 0.6361493808882577, 0.6510087142185289, 0.660540049173394, 0.6315826177597046, 0.6398888558757548, 0.6460703562717048, 0.643742001786524, 0.6354964424152764, 0.6504136980796347, 0.649098775824722, 0.6242019302990972, 0.6264484901817478, 0.6450562598753948, 0.6266809616770063, 0.6517342402010547, 0.6276436958994184, 0.6181489813084505, 0.6310569206062628, 0.6306080307279315, 0.6263453473850172, 0.619693228176662, 0.6110495170768426, 0.6261660140387866, 0.6150690329318144, 0.6313625245678182, 0.6307727731004054, 0.6057579128109679, 0.6223282692383747, 0.6000890001958731, 0.6000455952420527, 0.6075886974529344, 0.6120956673914072, 0.6070947780901071, 0.6085902440304659, 0.6047484655769504, 0.6094957188684114, 0.6065772954298525, 0.5911889660115145, 0.6088407088299187, 0.5953899919986725, 0.6247992016831223, 0.574770344763386, 0.5807342054892559, 0.5801236897098775, 0.5756749425615583, 0.5707455411249277, 0.5972844909648506, 0.5715514105193469, 0.5701840252292399, 0.6040317732460645, 0.5830919207358847, 0.5652814775097127, 0.5718977804086647, 0.6046391506584323, 0.5763191094203871, 0.5693395952789151, 0.5673952187810626, 0.5813678466543859, 0.5720378428089375, 0.5796576689700691, 0.568236692827575, 0.5543857228999235, 0.5614298618569666, 0.5703352969519946, 0.5627292546690726, 0.5708769231426473, 0.5609115009405174, 0.5502920929266482, 0.5529061276085523, 0.5570963645467952, 0.5548648700422171, 0.5544254609516689, 0.5619036166035399, 0.5495916568503088, 0.5941036769321987, 0.5563583909248819, 0.5559322152818952, 0.5588923595389541, 0.5560460723176295, 0.5436440973865743, 0.550779678383652, 0.5571155791379967, 0.5593913890877549, 0.5347369957943352, 0.5454466829494554, 0.5479405656152841, 0.5268385264338279, 0.5550602844783238, 0.5454740925711028, 0.5539796036116931, 0.5507271168183308, 0.5260680500341921, 0.5547019389210915, 0.5529694362562529, 0.539170892871156, 0.552070711340223, 0.5300040987073159, 0.5303197393611986, 0.5247312321954843, 0.5226481277115491, 0.5629798246889698, 0.5347196593576548, 0.529020796016771, 0.5345201893728606, 0.5159235657477865, 0.5127121587188876, 0.5246992488296665, 0.5301399522898148, 0.5322970383021296, 0.5170588426443995, 0.5073786073801468, 0.503254695814483, 0.5194811699341755, 0.5252317147595542, 0.5117932582388118, 0.5312491825648716, 0.521041219939991, 0.5274139746111266, 0.5033612494566002, 0.5381973033048668, 0.5122486644861649, 0.507986303494901, 0.5365559470896818, 0.5120748701144238, 0.4921874902686294, 0.5020261175778448], 'acc': [0.2844387755102041, 0.5522959183673469, 0.5739795918367346, 0.5956632653061223, 0.6339285714285714, 0.6147959183673469, 0.6288265306122448, 0.6466836734693877, 0.6288265306122448, 0.6441326530612245, 0.6568877551020408, 0.6428571428571428, 0.659438775510204, 0.6632653061224489, 0.6836734693877551, 0.6721938775510203, 0.6951530612244897, 0.6836734693877551, 0.6875, 0.7040816326530611, 0.6798469387755102, 0.6900510204081632, 0.6772959183673469, 0.6836734693877551, 0.6836734693877551, 0.6926020408163265, 0.7155612244897959, 0.6989795918367346, 0.7002551020408163, 0.6823979591836734, 0.7244897959183673, 0.6823979591836734, 0.7181122448979591, 0.7104591836734694, 0.735969387755102, 0.7040816326530611, 0.7244897959183673, 0.7168367346938775, 0.7155612244897959, 0.7232142857142857, 0.7155612244897959, 0.7193877551020408, 0.7334183673469388, 0.7270408163265305, 0.7130102040816326, 0.7257653061224489, 0.7257653061224489, 0.7193877551020408, 0.7181122448979591, 0.7397959183673469, 0.7257653061224489, 0.7257653061224489, 0.7283163265306122, 0.7155612244897959, 0.7193877551020408, 0.7066326530612245, 0.7244897959183673, 0.7206632653061223, 0.7155612244897959, 0.735969387755102, 0.7295918367346939, 0.735969387755102, 0.7334183673469388, 0.7448979591836734, 0.7487244897959183, 0.7423469387755102, 0.7563775510204082, 0.7487244897959183, 0.7436224489795917, 0.7423469387755102, 0.7589285714285714, 0.7397959183673469, 0.7448979591836734, 0.7410714285714285, 0.7691326530612245, 0.7474489795918366, 0.7474489795918366, 0.7576530612244897, 0.7461734693877551, 0.7665816326530611, 0.7563775510204082, 0.7512755102040816, 0.7372448979591836, 0.7538265306122448, 0.7640306122448979, 0.7499999999999999, 0.7461734693877551, 0.770408163265306, 0.7436224489795917, 0.7576530612244897, 0.7640306122448979, 0.7423469387755102, 0.7525510204081632, 0.7589285714285714, 0.7716836734693877, 0.760204081632653, 0.7665816326530611, 0.7538265306122448, 0.7563775510204082, 0.7551020408163265, 0.7627551020408163, 0.760204081632653, 0.774234693877551, 0.7665816326530611, 0.7589285714285714, 0.770408163265306, 0.7678571428571428, 0.7576530612244897, 0.7806122448979591, 0.7640306122448979, 0.7755102040816326, 0.7576530612244897, 0.7806122448979591, 0.7818877551020408, 0.7614795918367346, 0.798469387755102, 0.7755102040816326, 0.7895408163265305, 0.7755102040816326, 0.774234693877551, 0.7576530612244897, 0.7920918367346939, 0.7946428571428571, 0.7576530612244897, 0.7627551020408163, 0.7895408163265305, 0.7818877551020408, 0.7538265306122448, 0.7946428571428571, 0.7767857142857142, 0.7806122448979591, 0.7716836734693877, 0.7895408163265305, 0.7793367346938775, 0.7869897959183673, 0.7959183673469387, 0.7971938775510203, 0.7933673469387754, 0.7869897959183673, 0.7869897959183673, 0.7716836734693877, 0.7869897959183673, 0.7895408163265305, 0.7895408163265305, 0.8061224489795917, 0.7920918367346939, 0.8010204081632653, 0.7971938775510203, 0.7691326530612245, 0.7971938775510203, 0.7933673469387754, 0.7806122448979591, 0.7971938775510203, 0.8048469387755102, 0.7997448979591836, 0.7997448979591836, 0.7895408163265305, 0.8022959183673469, 0.8010204081632653, 0.784438775510204, 0.8061224489795917, 0.7793367346938775, 0.798469387755102, 0.7818877551020408, 0.7806122448979591, 0.8073979591836734, 0.7857142857142857, 0.7882653061224489, 0.798469387755102, 0.7882653061224489, 0.7997448979591836, 0.7895408163265305, 0.8150510204081632, 0.7946428571428571, 0.7971938775510203, 0.7959183673469387, 0.8048469387755102, 0.8073979591836734, 0.8099489795918366, 0.8201530612244897, 0.7920918367346939, 0.8022959183673469, 0.8022959183673469, 0.8048469387755102, 0.8214285714285714, 0.8163265306122448, 0.8073979591836734, 0.8035714285714285, 0.8073979591836734, 0.798469387755102, 0.8061224489795917, 0.8073979591836734, 0.8137755102040816, 0.8112244897959183, 0.8137755102040816, 0.7997448979591836, 0.8099489795918366, 0.8124999999999999, 0.8303571428571428, 0.8214285714285714]}
with open("train.txt","rb") as train_file:
    train=pickle.load(train_file)
with open("val.txt","rb") as val_file:
    val=pickle.load(val_file)

print("       ","val               ","train")
print("loss:  ",min(val["loss"]),min(train["loss"]))
print("acc:   ",max(val["acc"]),max(train["acc"]))

epoch_idx=np.arange(len(train["acc"]))
epoch_idx+=1

plt.title("loss graph")
plt.xlabel("epoch")
plt.ylabel("loss")
plt.plot(epoch_idx,train['loss'],color="green",label="train loss")
plt.plot(epoch_idx,val['loss'],color='red',label="val loss")
plt.legend()
plt.show()

plt.title("Accuracy graph")
plt.xlabel("epoch")
plt.ylabel("Accuracy")
plt.plot(epoch_idx,train['acc'],color="green",label="train loss")
plt.plot(epoch_idx,val['acc'],color='red',label="val loss")
plt.legend()
plt.show()
